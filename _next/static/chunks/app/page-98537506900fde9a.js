(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1057:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(5155),l=t(2115),r=t(5318),i=t(2543),c=t(7824),n=t(7933),o=t(6273),d=t(4633),m=t(7223),x=t(2200),h=t(6766);let p=e=>{let{children:s,className:t="",variant:l="default",onClick:r,...i}=e;return(0,a.jsx)("button",{className:"px-4 py-2 rounded-lg ".concat("ghost"===l?"hover:bg-gray-100":"bg-blue-500 text-white hover:bg-blue-600"," ").concat(t),onClick:r,...i,children:s})},j=e=>{let{open:s,onOpenChange:t,children:l}=e;return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full relative",children:[(0,a.jsx)("button",{className:"absolute top-2 right-2 p-1 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white",onClick:()=>t(!1),"aria-label":"Close dialog",children:(0,a.jsx)(r.A,{className:"h-5 w-5"})}),l]})}):null},u=e=>{let{children:s}=e;return s},f={id:"1356062",size:3.2,state:"State of Par\xe1",municipality:"Santar\xe9m",source:"Sentinel-2",dates:{before:"10/02/2024",after:"12/03/2024",detected:"01/03/2024"},photos:["/data/close1.jpg"],historicalImages:[{date:"Feb 2024",url:"/data/1.png"},{date:"Mar 2024",url:"/data/2.png"},{date:"Apr 2024",url:"/data/3.png"}]},g={lat:-4.5,lng:-54.5},y={mapTypeControl:!0,mapTypeControlOptions:{style:2,position:3,mapTypeIds:["roadmap","satellite"]},streetViewControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},v=function(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)([]),[v,N]=(0,l.useState)(!0),[b,w]=(0,l.useState)(null),[C,A]=(0,l.useState)("territories"),[k,E]=(0,l.useState)(null),[S,T]=(0,l.useState)(null),[D,O]=(0,l.useState)(!1),[L,M]=(0,l.useState)(g),[F,I]=(0,l.useState)(5),[_,z]=(0,l.useState)(!1),[P,R]=(0,l.useState)(!1),[B,V]=(0,l.useState)(.5),G=(0,l.useCallback)((e,s)=>{let t=s.getBoundingClientRect();V(Math.max(0,Math.min(1,(e.clientX-t.left)/t.width)))},[]);(0,l.useEffect)(()=>{(async function(){try{let e=await fetch("/data/territories.geojson");if(!e.ok)throw Error("Failed to load territories data");let t=await e.json();s(t.features),N(!1)}catch(e){console.error("Error loading GeoJSON:",e),w(e.message),N(!1)}})()},[]),(0,l.useEffect)(()=>{(async function(){try{let e=await fetch("/data/maro_alerts.geojson");if(!e.ok)throw Error("Failed to load alerts data");let s=await e.json();r(s.features),N(!1)}catch(e){console.error("Error loading data:",e),w(e.message),N(!1)}})()},[]),(0,l.useEffect)(()=>{if(k&&k.coordinates&&"undefined"!=typeof google)try{let e=new google.maps.LatLngBounds,s=k.coordinates.filter(e=>Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&isFinite(e[0])&&isFinite(e[1]));if(s.length>0){s.forEach(s=>{e.extend(new google.maps.LatLng(s[1],s[0]))});let t={lat:(e.getNorthEast().lat()+e.getSouthWest().lat())/2,lng:(e.getNorthEast().lng()+e.getSouthWest().lng())/2};M(t),I(10)}}catch(e){console.error("Error calculating map bounds:",e)}},[k]);let W=(0,l.useMemo)(()=>e.map(e=>({name:e.properties.name,area:e.properties.area,coordinates:e.geometry.coordinates[0]})),[e]),q=l.memo(()=>{let[e,s]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{s(!0)},[]),v)?(0,a.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl text-gray-600",children:(0,a.jsx)("div",{className:"animate-pulse",children:"Loading territories..."})})}):b?(0,a.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-xl text-red-600",children:["Error: ",b]})}):(0,a.jsxs)("div",{className:"h-screen flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 bg-primary",children:(0,a.jsx)("h1",{className:"text-2xl font-semibold text-center text-white",children:"Guardi\xe3o"})}),(0,a.jsxs)("div",{className:"flex-grow flex flex-col",children:[e&&(0,a.jsx)(x.aJ,{googleMapsApiKey:"AIzaSyD0Rx_IfSB385t_-un9MF4IGjE3MYqvOjI",children:(0,a.jsxs)(x.u6,{mapContainerClassName:"flex-grow",center:L,zoom:F,options:y,children:[W.map((e,s)=>(0,a.jsx)(H,{territory:e,onClick:()=>{E(W[s]),A("alerts")}},e.name)),t.map(e=>(0,a.jsx)(K,{alert:e,onClick:()=>{T(e),A("alert-details")}},e.properties.CODEALERTA))]})}),(0,a.jsxs)("div",{className:"p-4 bg-white shadow-lg",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Alerts"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[t.length," deforestation alerts detected"]})]}),W.map(e=>(0,a.jsxs)(p,{variant:"outline",className:"px-4 py-4 rounded-lg bg-blue-500 text-white hover:bg-blue-600 w-full flex items-center justify-center bg-primary text-white hover:bg-primary/80 w-full mb-2 justify-between py-4 border-primary hover:bg-primary hover:text-white",onClick:()=>{E(e),A("alerts")},children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)("span",{children:["(",e.area.toLocaleString()," ha)"]})]},e.name))]})]})]})});q.displayName="TerritoriesView";let H=l.memo(e=>{let{territory:s,onClick:t}=e,r=(0,l.useMemo)(()=>s.coordinates.filter(e=>Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&isFinite(e[0])&&isFinite(e[1])).map(e=>({lat:e[1],lng:e[0]})),[s]);return(0,a.jsx)(x.tS,{paths:r,options:{fillColor:"transparent",fillOpacity:0,strokeColor:"#ac6eee",strokeWeight:2},onClick:t})});H.displayName="TerritoryPolygon";let J=l.memo(()=>{let[e,s]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{s(!0)},[]),(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-white",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center bg-primary",children:[(0,a.jsx)(p,{variant:"ghost",className:"text-white hover:bg-white hover:text-primary",onClick:()=>A("territories"),children:(0,a.jsx)(i.A,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"text-xl font-semibold ml-2 text-white",children:null==k?void 0:k.name})]}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("div",{className:"relative h-1/2",children:e&&(0,a.jsx)(x.aJ,{googleMapsApiKey:"AIzaSyD0Rx_IfSB385t_-un9MF4IGjE3MYqvOjI",children:(0,a.jsxs)(x.u6,{mapContainerClassName:"w-full h-full",center:L,zoom:F,options:y,children:[k&&(0,a.jsx)(H,{territory:k}),t.map(e=>(0,a.jsx)(K,{alert:e,onClick:()=>{T(e),A("alert-details")}},e.properties.CODEALERTA))]})})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"font-semibold mb-3",children:"Active Alerts"}),(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left font-semibold",children:"Alert ID"}),(0,a.jsx)("th",{className:"text-left font-semibold",children:"Status"}),(0,a.jsx)("th",{className:"text-left font-semibold",children:"Size (ha)"}),(0,a.jsx)("th",{className:"text-left font-semibold",children:"Detected"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{className:"cursor-pointer hover:bg-primary duration-200",onClick:()=>{T(f),A("alert-details")},children:[(0,a.jsxs)("td",{className:"px-4 py-2",children:["#",f.id]}),(0,a.jsx)("td",{className:"px-4 py-2 text-red-500",children:"Ongoing"}),(0,a.jsx)("td",{className:"px-4 py-2",children:f.size}),(0,a.jsx)("td",{className:"px-4 py-2",children:f.dates.detected})]},f.id),t.map(e=>(0,a.jsxs)("tr",{className:"cursor-pointer hover:bg-primary duration-200",onClick:()=>{T(e),A("alert-details")},children:[(0,a.jsxs)("td",{className:"px-4 py-2",children:["#",e.properties.CODEALERTA]}),(0,a.jsx)("td",{className:"px-4 py-2 text-red-500"}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.properties.AREAHA}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.properties.DATADETEC})]},e.properties.CODEALERTA))]})]})]})]})]})});J.displayName="AlertsView";let K=l.memo(e=>{let{alert:s,onClick:t}=e,r=(0,l.useMemo)(()=>s.geometry.coordinates[0].filter(e=>Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&isFinite(e[0])&&isFinite(e[1])).map(e=>({lat:e[1],lng:e[0]})),[s]);return(0,a.jsx)(x.tS,{paths:r,options:{fillColor:"transparent",fillOpacity:0,strokeColor:"#FF0000",strokeWeight:2},onClick:t})});K.displayName="AlertPolygon";let Y=l.memo(()=>(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-white",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center bg-primary",children:[(0,a.jsx)(p,{variant:"ghost",className:"text-white hover:bg-white hover:text-primary",onClick:()=>A("alerts"),children:(0,a.jsx)(i.A,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"text-xl font-semibold ml-2 text-white",children:"Alert Details"})]}),(0,a.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Code"}),(0,a.jsx)("div",{children:f.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Area"}),(0,a.jsxs)("div",{children:[f.size," ha"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600",children:"State"}),(0,a.jsx)("div",{children:f.state})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Municipality"}),(0,a.jsx)("div",{children:f.municipality})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Source"}),(0,a.jsx)("div",{children:f.source})]})]}),(0,a.jsxs)("div",{className:"relative h-64 mb-4 overflow-hidden cursor-ew-resize",onMouseDown:e=>{let s=e.currentTarget;G(e,s);let t=e=>{e.preventDefault(),G(e,s)},a=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",a)},children:[(0,a.jsx)("div",{className:"absolute inset-0",children:(0,a.jsx)(h.default,{src:"/data/after.jpg",alt:"After",className:"object-cover",draggable:!1,fill:!0})}),(0,a.jsx)("div",{className:"absolute inset-0",style:{clipPath:"inset(0 ".concat(100-100*B,"% 0 0)")},children:(0,a.jsx)(h.default,{src:"/data/before.jpg",alt:"Before",className:"object-cover",draggable:!1,fill:!0})}),(0,a.jsx)("div",{className:"absolute inset-y-0 w-1 bg-white",style:{left:"".concat(100*B,"%")},children:(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-8 h-8 bg-primary text-white rounded-full shadow-lg flex items-center justify-center",children:(0,a.jsx)("div",{children:"↔"})})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Historical Timeline"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2",children:f.historicalImages.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"relative w-24 h-24",children:(0,a.jsx)(h.default,{src:e.url,alt:"Historical image ".concat(e.date),className:"object-cover rounded",fill:!0})}),(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("div",{className:"font-medium",children:e.date})})]},s))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:["Before: ",f.dates.before]}),(0,a.jsxs)("div",{children:["Detected: ",f.dates.detected]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{children:["After: ",f.dates.after]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(p,{className:"w-full flex items-center justify-center gap-2 bg-primary text-white hover:bg-primary/80",onClick:()=>{},children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Plot Route"]}),(0,a.jsxs)(p,{className:"w-full flex items-center justify-center gap-2 bg-primary text-white hover:bg-primary/80",onClick:()=>O(!0),children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),"Take Photo"]}),(0,a.jsxs)(p,{className:"w-full flex items-center justify-center gap-2 bg-primary text-white hover:bg-primary/80",onClick:()=>R(!0),children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"Add Voice Note"]})]})]})})]}));return Y.displayName="AlertDetailsView",(0,a.jsxs)("div",{className:"max-w-md mx-auto border h-screen",children:["territories"===C&&(0,a.jsx)(q,{}),"alerts"===C&&(0,a.jsx)(J,{}),"alert-details"===C&&(0,a.jsx)(Y,{}),(0,a.jsx)(j,{open:D,onOpenChange:O,children:(0,a.jsx)(u,{children:(0,a.jsxs)("div",{className:"p-4 pt-6",children:[(0,a.jsx)("h2",{className:"font-semibold mb-4 text-primary dark:text-primary",children:"Photos"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:f.photos.map((e,s)=>(0,a.jsx)("div",{className:"relative w-full aspect-square",children:(0,a.jsx)(h.default,{src:e,alt:"Photo ".concat(s+1),className:"object-cover rounded",fill:!0})},s))}),(0,a.jsxs)(p,{className:"w-full flex items-center justify-center gap-2 bg-primary text-white hover:bg-primary/80",onClick:()=>{},children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),"Take New Photo"]}),(0,a.jsx)(p,{className:"w-full mt-2 flex items-center justify-center gap-2",onClick:()=>O(!1),children:"Close"})]})})}),(0,a.jsx)(j,{open:P,onOpenChange:R,children:(0,a.jsx)(u,{children:(0,a.jsxs)("div",{className:"p-4 pt-6",children:[(0,a.jsx)("h2",{className:"font-semibold mb-4 text-primary dark:text-primary",children:"Voice Note"}),(0,a.jsx)("div",{className:"flex justify-center mb-4",children:_?(0,a.jsx)("button",{className:"p-4 rounded-full bg-red-500 text-white",onClick:()=>z(!1),children:(0,a.jsx)(d.A,{className:"h-12 w-12"})}):(0,a.jsx)("button",{className:"p-4 rounded-full bg-primary text-white",onClick:()=>z(!0),children:(0,a.jsx)(o.A,{className:"h-12 w-12"})})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:_?"Recording...":"Tap to record"}),!_&&(0,a.jsx)("button",{className:"p-1 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white",onClick:()=>{},children:(0,a.jsx)(m.A,{className:"h-5 w-5"})})]}),(0,a.jsx)(p,{className:"w-full mt-4 flex items-center justify-center gap-2",onClick:()=>R(!1),children:"Close"})]})})})]})}},2352:(e,s,t)=>{Promise.resolve().then(t.bind(t,1057))}},e=>{var s=s=>e(e.s=s);e.O(0,[84,4,441,684,358],()=>s(2352)),_N_E=e.O()}]);